<h1>Splunk Investigation 2 Lab</h1>



<h2>Description</h2>
Security Information and Event Monitoring
Using Splunk SIEM
Lab) Splunk Investigation 2 Solution<br />


<h2>Languages and Utilities Used</h2>

- <b>PowerShell</b> 
- <b>Splunk</b>

<h2>Environments Used </h2>

- <b>Windows 10</b> 

<h2>Program walk-through </h2>


- <b>Splunk Investigation 2 Completion Certification </b>
  - [SCertification of completion1]([http://www.keepandshare.com/doc8/view.php?id=30596&da=y](https://elearning.securityblue.team/public/lab-certificate/6c8a44cc-6346-425c-896d-a82b6d4d063b))
 
<b>Question 1 - What is the name of the web vulnerability scanner that is being used?</b>

There is a wide range of ways we can approach this investigation, as we are not provided with the pre-written search queries in this lab. Let's assume we're not familiar with Splunk, so we can't just write a perfect search to find this information instantly. Let's go step-by-step and build up our query!

First, we want to find events with the sourcetype fortiguate_utm, so we'll turn Event Sampling to 1:100 (as we don't want to search through every single log just to retrieve the sourcetype) and run a search for index="botsv1".

 ![image](https://github.com/abdullaah019/splunkinvestigation2/assets/139023222/60e78e7e-caaf-4608-9f65-bbe6a3afc8e1)


On the left-hand panel, we'll see ‘sourcetype’ under the ‘SELECTED FIELDS’ heading. After clicking on sourcetype we can see fortigate_utm is listed. Clicking on this will add that filter to our search query.

 ![image](https://github.com/abdullaah019/splunkinvestigation2/assets/139023222/5589a1f0-a5bf-4467-a802-ceee424d961f)


Our search query is now index="botsv1" sourcetype=fortigate_utm. Let's turn Event Sampling off (No Event Sampling) and wait for the search to finish.

Next we're looking for a field that will hold the domain we're looking for, imreallynotbatman.com. Scrolling down the Interesting Fields we find ‘url_domain’, and clicking on it shows the domain we're interested in. We can click the value to add it to our search.

 ![image](https://github.com/abdullaah019/splunkinvestigation2/assets/139023222/aab662e4-b2ef-42c7-be95-8c7019f721d2)


Our search query is now index="botsv1" sourcetype=fortigate_utm url_domain="imreallynotbatman.com". The final part the scenario told us about is including the string ‘vulnerability’. We can add this by simply writing vulnerability at the end of our search query, giving us a final query of index="botsv1" sourcetype=fortigate_utm url_domain="imreallynotbatman.com" vulnerability.

Going back to the question now that our query is built, looking at the Event Details panel we can see that the text ‘vulnerability’ is highlighted, showing us that two fields in these logs, ‘attack’ and ‘msg’ inform us that the traffic is being generated by the Acunetix Web Vulnerability Scanner.

 ![image](https://github.com/abdullaah019/splunkinvestigation2/assets/139023222/f068eba9-a56d-44e6-b855-30028f113ed3)


<b>Question 2 - What is the source IP of the vulnerability scanner, and therefore the attacker?</b>

Looking at the events our search has found, we can see that the field ‘srcip’ is being used by this log to hold the source IP address value.

 ![image](https://github.com/abdullaah019/splunkinvestigation2/assets/139023222/625ebd7b-bfb9-45bd-9ab3-483ce940cbb8)


<b>Question 3 - What is the destination IP? (the internal address for our web server)</b>

Looking at the events our search has found, we can see that the field ‘dstip’ is being used by the log to hold the destination IP address value.

 ![image](https://github.com/abdullaah019/splunkinvestigation2/assets/139023222/7de71f53-8f53-4f06-996e-e16fceb5d441)

<b>Question 4 - Fortigate UTM provides enrichment, and can tell us the source IP country based on a lookup. What country is the scanning IP associated with?</b>

Looking at the events our search has found, we can see that the field ‘srccountry’ is being used by this log to hold the source IP address country value.

 ![image](https://github.com/abdullaah019/splunkinvestigation2/assets/139023222/90aed54c-63ff-428d-b679-0328b681de7b)

<b>Question 5 - What is the timestamp in the first Fortigate UTM log referencing the vulnerability scan, on 8/10/16, in the format HH:MM:SS? (Use the log timestamp, not the Time column next to the event)</b>

Keeping the same search query, we want to sort these events based on the ‘time’ field within the logs. To do this, we'll use the ‘sort’ functionality in our query. All we need to do is add | sort _time asc to the end of our search, which will sort all the events in time ascending order, putting the first events at the top.

 ![image](https://github.com/abdullaah019/splunkinvestigation2/assets/139023222/2a4fb6a2-fac0-427d-adcf-a98c13fe7af8)




<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
